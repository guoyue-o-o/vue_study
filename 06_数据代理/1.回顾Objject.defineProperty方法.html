<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>回顾Objject.defineProperty方法</title>
</head>

<body>
    <!-- Object.defineProperty():
            直接在一个对象上定义一个新属性，或者修改一个已经存在的属性 
            
            Object.defineProperty(obj, prop, desc)
                1.obj 需要定义属性的当前对象
                2.prop 当前需要定义的属性名
                3.desc 属性描述符
    -->

    <script>

        console.log('示例1================================================================================================================== ');
        let number = 19;
        let person = {
            name: '张三',
            sex: '男',
        }
        // Object.defineProperty(obj, prop, desc)
        // 通过这种方式不可以随意更改、删除、枚举，需要设置相关属性
        Object.defineProperty(person, 'age', {
            // value: 18,
            // enumerable: true, // 控制属性是否可以枚举,默认是false
            // writable: true, // 控制属性是否可以被修改，默认是false
            // configurable: true // 控制属性是否可以被删除，默认是false

            get() { // 当有人读取person的age属性的时候，get函数就被调用，且返回值就是age
                // this指向person
                console.log('================读取age属性了=================== ', 'this指向===>', this);
                return number;
            },

            set(value) { // 当修改age属性时，set函数（setter)就会被调用，且会收到修改的具体值
                console.log('================修改age属性，且值是=================== ', value);
                console.log('================value=================== ', value);
                number = value;
            }
        })
        console.log('================person=================== ', person);

        /*  
        enumerable:
             // 遍历
             console.log('================Object.keys(person)=================== ',Object.keys(person));
             // 遍历
             for (const key in person) {
                 if (Object.hasOwnProperty.call(person, key)) {
                     const element = person[key];
                     console.log('================key=================== ',key);
                 }
             } 
         */





         console.log('示例2================================================================================================================== ');
        // Object.defineProperty 给对象定义一个属性
        let student = {}
        Object.defineProperty(student, 'name', {
            // 注意：
            // 描述符中不可以同时拥有 get, writable, set，同时使用会报错 
            enumerable: true,
            // writable: true,
            get() {
                console.log('================读取=================== ');
                return '学生'
            },
            set() {
                console.log('================设置=================== ', this);
            },
        })
        console.log('================student=================== ', student);

        // (enumerable默认为false，不可枚举) Object.keys(student)=[]
        // enumerable: true, 可以访问key Object.keys(student)=['name']
        console.log('================Object.keys(student)=================== ', Object.keys(student)); // ================Object.keys(student)===================  []





        console.log('示例3================================================================================================================== ');
        // get(), set() 可以直接在对象中使用，
        // price 为属性值
        let book = {
            tempVal: '小王子',
            get price() {
                console.log('================get=================== ', this);
                return this.tempVal;
            },
            set price(newVal) {
                console.log('================set=================== ', newVal);
                this.tempVal = newVal;
            }
        }
        book.price = 60
        console.log('================book=================== ', book);

    </script>

</body>

</html>